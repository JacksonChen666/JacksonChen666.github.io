<html>
	<head>
		<title>Live HTML Editor</title>
		<meta name="viewport" content="width=device-width initial-scale=1">
		<script>
			var time = new Date();
			function statusRefresh(text){
				time = new Date();
				console.log(text + " " + time);
			}
			var main;
			var wideLocalStorageName = "RTE_HTML";
			function refresh(){
				window.clearTimeout(main);
				main = setTimeout(refreshING,500);
			}
			function refreshING(){
				var textContent = document.getElementById('editor-textarea').value;
				document.getElementById('viewer').srcdoc = textContent;
				statusRefresh("Refreshed");
				saveLocal();
			}

			function saveLocal(localStorageName = wideLocalStorageName){
				var textContent = document.getElementById('editor-textarea').value;
				localStorage.setItem(localStorageName, textContent);
				statusRefresh("Saved");
			}

			function loadLocal(){
				if (typeof localStorage.RTE_HTML === 'undefined') {
					return localStorage.RTE_HTML;
				} else if (typeof localStorage.RTE_HTML === 'null') {
					return localStorage.RTE_HTML;
				} else {
					document.getElementById('editor-textarea').value = localStorage.RTE_HTML;
					refresh();
					statusRefresh("Loaded");
					return localStorage.RTE_HTML;
				}
			}

			function oldLoadLocal(oldLocalStorageName){
				if (typeof localStorage.oldLocalStorageName === 'undefined'){
					console.log('Old local storage not found! ' + oldLocalStorageName);
					return(oldLocalStorageName);
				} else if (typeof localStorage.oldLocalStorageName === 'null'){
					console.log('Old local storage not found! ' + oldLocalStorageName);
					return(oldLocalStorageName);
				} else {
					document.getElementById('editor-textarea').value = localStorage.oldLocalStorageName;
					refresh();
					statusRefresh("Loaded from old local storage! " + localStorage.oldLocalStorageName);
					localStorage.setItem(oldLocalStorageName, undefined);
					statusRefresh("Converted from old local storage! " + oldLocalStorageName);
				}
			}

			function allOfOldLoadLocal(){
				oldLoadLocal("RTE_HTML_File");
			}

			function load(){
				loadLocal();
				saveLocal();
			}
		</script>
		<style>
			* {
				margin: 0;
				padding: 0;
				color: white;
				background-color: #202020;/* #202020 dark mode, #bdc3c7 light mode */
			}
			.extra {
				padding-top: 5px;
				text-align: center;
			}
			.main {
				width: 100%;
				height: calc(100vh - 95px); /* Dynamic screen height of verticle screen height */
				margin-bottom: 0px;
				display: inline-flex;
			}
			#editor-textarea {
				background-color: #303030; /* #303030 dark mode, #fff light mode */
				height: 100%;
				min-width: 30px;
				color: white;
				resize: none;
				outline: none;
				width: 100%;
				margin: 10px;
				padding: 5px;
				font-family:Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace; /* Monospace */
			}
			#viewer {
				background-color: #606060; /* #707070 dark mode, #fff light mode */
				min-width: 100px;
				border: none;
				min-height: 30px;
				width: 100%;
				height: 100%;
				margin: 10px;
				border: 1px solid #3498db;
			}
		</style>
	</head>
	<body>
		<noscript style="font-size: 300px;">Enable JavaScript</noscript>
		<div class="extra" id="extra">
			<h1 style="font-size: 24px;">Live HTML Editor</h1>
			<a href="https://www.youtube.com/watch?v=onLsz9BwP7M" style="font-size: 12px;">Original creator and code</a>&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="allOfOldLoadLocal()">Load from old local storage</a>&nbsp;&nbsp;&nbsp;<a href="./LHE-FAQ.html" style="font-size: 12px;">FAQ</a><br>
			<p style="font-size: 8px;">Background color is not affected unless set | Tab indent unsupported</p>
		</div>
		<div class="main" id="main">
			<textarea id="editor-textarea" onkeyup="refresh()" style="font-size: 15px;" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" autofocus="true" placeholder="HTML code (JS and CSS included, spellcheck off)"></textarea>
			<iframe id="viewer"></iframe>
		</div>
	<script type="text/javascript">
		load();
	</script>
	</body>
</html>